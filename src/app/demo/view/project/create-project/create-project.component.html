<p-tabView [(activeIndex)]="activeIndex">
    <p-tabPanel header="Project Information">
        <div>
            <h5>Project Information</h5>
        </div>
        <hr class="align">
        <form [formGroup]="myForm">
            <div class="p-fluid grid">
                <div class="field col-12 md:col-3">
                    <div class="p-d-block"><label>Company Name<span class="requiredField">*</span></label></div>
                    <p-dropdown [options]="companyOptions" (onChange)="onCompanySelect($event)" optionLabel="name"
                        optionValue="id" formControlName="companyName" placeholder="Select Company Name" [filter]="true"
                        filterBy="name"></p-dropdown>
                </div>
                <div class="field col-12 md:col-3">
                    <div class="p-d-block"><label>Company Code</label></div>
                    <input placeholder="Enter Customer Code" formControlName="customerCode" type="text" pInputText>
                </div>
                <div class="field col-12 md:col-3">
                    <div class="p-d-block"><label>Opportunity Name<span class="requiredField">*</span></label></div>
                    <p-dropdown [options]="opportunityNameOptions" optionLabel="name"
                        (onChange)="onOpportunitySelect($event)" optionValue="id" formControlName="opportunityName"
                        placeholder="Select Opportunity Name" [filter]="true" filterBy="name"></p-dropdown>
                    <!-- <input   placeholder="Enter Opportunity Name" formControlName="opportunityName" type="text" 
                        pInputText> -->
                </div>

                <div class="field col-12 md:col-3">
                    <div class="p-d-block"><label>Industry Vertical<span class="requiredField">*</span></label></div>
                    <p-dropdown [options]="IVOptions" optionLabel="name" optionValue="id"
                        formControlName="industryVertical" placeholder="Enter Industry Vertical" [filter]="true"
                        filterBy="name"></p-dropdown>
                    <!-- <input  placeholder="Enter Industry Vertical" formControlName="industryVertical" type="text"
                    pInputText> -->
                </div>
                <div class="field col-12 md:col-3">
                    <div class="p-d-block"><label>Region<span class="requiredField">*</span></label></div>
                    <p-dropdown [options]="regionOptions" formControlName="region" placeholder="Select Region"
                        optionLabel="name" optionValue="id" [filter]="true" filterBy="name"></p-dropdown>
                </div>
                <br>


                <div class="field col-12 md:col-3">
                    <div class="p-d-block"><label>Project Name<span class="requiredField">*</span></label></div>
                    <input formControlName="projectName" placeholder="Enter Project Name" type="text" id="inputtext"
                        pInputText>
                </div>
                <div class="field col-12 md:col-3">
                    <div class="p-d-block"><label>Project Stage<span class="requiredField">*</span></label></div>
                    <p-dropdown [options]="projectStageOptions" formControlName="projectStage"
                        (onChange)="OnStageSelectProjectstatus($event)" placeholder="Select Project Stage"
                        optionLabel="name" optionValue="id" [filter]="true" filterBy="name"></p-dropdown>
                </div>
                <div class="field col-12 md:col-3">
                    <div class="p-d-block"><label>Project Status<span class="requiredField">*</span></label></div>
                    <p-dropdown [options]="projectStatusOptions" formControlName="projectStatus"
                        placeholder="Select Project Status" optionLabel="name" optionValue="id" [filter]="true"
                        filterBy="name"></p-dropdown>
                </div>
                <div class="field col-12 md:col-6">
                    <div class="p-d-block"><label>Opportunity Manager<span class="requiredField">*</span></label></div>
                    <p-multiSelect [options]="opportunityManagerOptions" formControlName="opportunityManger"
                        optionLabel="name" optionValue="id" placeholder="Select Opportunity Manager" [filter]="true"
                        filterBy="name"></p-multiSelect>
                </div>
                <div class="field col-12 md:col-6">
                    <div class="p-d-block"><label>Date Range<span class="requiredField">*</span></label></div>
                    <input type="text" ngxDaterangepickerMd [lockStartDate]="false" formControlName="selectedDateRange"
                        placeholder="Start Date-End Date" class="date_pick" />
                </div>
                <div class="field col-12 md:col-6">
                    <div class="p-d-block"><label>Design Notes<span class="requiredField">*</span></label></div>
                    <textarea rows="4" cols="30" pInputTextarea formControlName="designNotes"
                        placeholder="Enter Design Notes" id="inputtext"></textarea>

                    <div class="error" *ngIf="myForm.get('designNotes').hasError('maxlength')">
                        Maximum character limit exceeded (1000 characters).
                    </div>
                </div>
                <div class="field col-12 md:col-6">
                    <div class="p-d-block"><label>Implementation Notes<span class="requiredField">*</span></label></div>
                    <!-- <input formControlName="impleNotes" placeholder="Enter Implementation Notes"  type="text" id="inputtext"
                    pInputText> -->
                    <textarea rows="4" cols="30" pInputTextarea formControlName="impleNotes"
                        placeholder="Enter Implementation Notes" id="inputtext"></textarea>
                    <div class="error" *ngIf="myForm.get('impleNotes').hasError('maxlength')">
                        Maximum character limit exceeded (1000 characters).
                    </div>
                </div>
            </div>
            <hr class="aligndown">
            <div><label>Location<span class="requiredField">*</span></label></div><br>
            <p>Please Select Location and add them for the project</p>
            <div class="p-fluid grid">
                <div class="field col-12 md:col-5">
                    <div class="p-d-flex p-align-center" style="padding-bottom: 8px;">
                        <p-checkbox [binary]="true" inputId="ny" [ngModel]="enableOriginLocation"
                            (onChange)="toggleOriginCheckbox()"></p-checkbox>
                        <label for="ny" style="padding-left: 6px;">Origin Location</label>
                    </div>
                    <p-multiSelect placeholder="Select Origin Location" optionLabel="name" optionValue="id"
                        display="chip" [showClear]="true" [options]="originLocations" [disabled]="!enableOriginLocation"
                        (onChange)="onOriginLocationChange($event)">
                    </p-multiSelect>

                </div>

                <div class="field col-12 md:col-5">
                    <div class="p-d-flex p-align-center" style="padding-bottom: 8px;">
                        <p-checkbox value="Destination Location" inputId="nyz" [binary]="true"
                            [ngModel]="enableDestinationLocation" (onChange)="toggleDestinationCheckbox()"></p-checkbox>
                        <label for="nyz" style="padding-left: 6px;">Destination Location</label>
                    </div>
                    <p-multiSelect placeholder="Select Destination Location" optionLabel="name" optionValue="id"
                        display="chip" [showClear]="true" [options]="destinationLocations"
                        [disabled]="!enableDestinationLocation" (onChange)="onDestinationLocationChange($event)">
                    </p-multiSelect>
                </div>
            </div>


            <p-accordion [activeIndex]="0">
                <p-accordionTab header="Selected Location Volume and UOM">
                    <div class="card">
                        <p-tabView>
                            <p-tabPanel header="Origin Location">

                                <p-toast></p-toast>

                                <p-table [value]="originTableControls.controls" dataKey="id" editMode="row"
                                    [tableStyle]="{'min-width': '50rem'}">
                                    <ng-template pTemplate="header">
                                        <tr>
                                            <th style="width:20%">Action</th>
                                            <th style="width:20%">Location</th>
                                            <th style="width:20%">Volume</th>
                                            <th style="width:20%">UOM</th>

                                        </tr>
                                    </ng-template>
                                    <ng-template pTemplate="body" let-product let-ri="rowIndex">
                                        <tr>
                                            <td>
                                                <div *ngIf="isActionButtonsVisible">
                                                    <div  >
                                                    <button pButton pRipple type="button" icon="pi pi-plus"
                                                        class="p-button-rounded p-button-text p-button-success"
                                                        (click)="onAddRowBelow(ri)"></button>
                                                    </div>
                                                    <button pButton pRipple type="button" icon="pi pi-check"
                                                        (click)="onSave($event, product)"
                                                        class="p-button-rounded p-button-text p-button-success mr-2"></button>
                                                    <button pButton pRipple type="button" pCancelEditableRow
                                                        icon="pi pi-times" (click)="onRowEditCancel(product, ri)"
                                                        class="p-button-rounded p-button-text p-button-danger"></button>
                                                    <button pButton pRipple type="button" icon="pi pi-pencil"
                                                        (click)="onRowEditInit(product, ri)"
                                                        class="p-button-rounded p-button-text p-button-warning"></button>
                                                    <button pButton pRipple type="button" icon="pi pi-trash"
                                                        class="p-button-rounded p-button-text p-button-danger"
                                                        (click)="onDeleteRow(ri)"></button>
                                                </div>

                                            <td>
                                                {{ getLocationName(product.get('location').value) }}

                                            </td>
                                            <td>
                                                <span *ngIf="!isRowEditMode[ri] || isAddingRow">{{
                                                    product.get('volume').value }}</span>
                                                <input *ngIf="(isRowEditMode[ri] && !isAddingRow)" pInputText
                                                type="number" placeholder="Enter Volume"
                                                    [formControl]="product.get('volume')" required>
                                            </td>
                                            <td>
                                                <span *ngIf="!isRowEditMode[ri] || isAddingRow">{{
                                                    product.get('uom').value }}</span>
                                                <p-dropdown *ngIf="(isRowEditMode[ri] && !isAddingRow)"
                                                    [options]="uomOptions" optionLabel="name" optionValue="id"
                                                    [formControl]="product.get('uom')" [appendTo]="'body'"
                                                    placeholder="Select UOM" [style]="{'width':'100%'}"></p-dropdown>
                                            </td>
                                        </tr>
                                    </ng-template>
                                </p-table>

                            </p-tabPanel>
                            <p-tabPanel header="Destination Location">
                                <p-toast></p-toast>
                                <p-table [value]="products" dataKey="id" editMode="row"
                                    [tableStyle]="{'min-width': '50rem'}">
                                    <ng-template pTemplate="header">
                                        <tr>
                                            <th style="width:20%">Action</th>
                                            <th style="width:20%">Location</th>
                                            <th style="width:20%">Volume</th>
                                            <th style="width:20%">UOM</th>

                                        </tr>
                                    </ng-template>
                                    <ng-template pTemplate="body" let-product let-editing="editing" let-ri="rowIndex">
                                        <tr [pEditableRow]="product">
                                            <td>
                                                <div>
                                                    <button *ngIf="!editing" pButton pRipple type="button"
                                                        icon="pi pi-plus" class="p-button-rounded p-button-text"
                                                        (click)="onAddRowBelow(ri)"></button>
                                                    <button *ngIf="!editing" pButton pRipple type="button"
                                                        pInitEditableRow icon="pi pi-pencil"
                                                        (click)="onRowEditInit(product)"
                                                        class="p-button-rounded p-button-text"></button>
                                                    <button *ngIf="editing" pButton pRipple type="button"
                                                        pSaveEditableRow icon="pi pi-check"
                                                        (click)="onRowEditSave(product)"
                                                        class="p-button-rounded p-button-text p-button-success mr-2"></button>
                                                    <button *ngIf="editing" pButton pRipple type="button"
                                                        pCancelEditableRow icon="pi pi-times"
                                                        (click)="onRowEditCancel(product, ri)"
                                                        class="p-button-rounded p-button-text p-button-danger"></button>
                                                    <button *ngIf="!editing" pButton pRipple type="button"
                                                        icon="pi pi-trash"
                                                        class="p-button-rounded p-button-text p-button-danger"
                                                        (click)="onDeleteRow(ri)"></button>

                                                </div>
                                            </td>
                                            <td>
                                                <p-cellEditor>
                                                    <ng-template pTemplate="input">
                                                        <input pInputText type="text">
                                                    </ng-template>
                                                    <ng-template pTemplate="output">
                                                        Delhi
                                                    </ng-template>
                                                </p-cellEditor>
                                            </td>
                                            <td>
                                                <p-cellEditor>
                                                    <ng-template pTemplate="input">
                                                        <input pInputText type="text" required>
                                                    </ng-template>
                                                    <ng-template pTemplate="output">
                                                        123
                                                    </ng-template>
                                                </p-cellEditor>
                                            </td>
                                            <td>
                                                <p-cellEditor>
                                                    <ng-template pTemplate="input">
                                                        <p-dropdown [options]="uomOptions" optionLabel="name"
                                                            appendTo="body" [style]="{'width':'100%'}"></p-dropdown>
                                                    </ng-template>
                                                    <ng-template pTemplate="output">
                                                        UOM
                                                    </ng-template>
                                                </p-cellEditor>
                                            </td>


                                        </tr>
                                    </ng-template>
                                </p-table>
                            </p-tabPanel>
                        </p-tabView>
                    </div>
                </p-accordionTab>
            </p-accordion>

            <h6><b>Documents</b></h6>
            <p>Upload the following documnets: File Size < 5 mb,Format CSV,JPEG,Excel,PDF</p>
            <div class="p-fluid grid">
                <div class="field col-12 md:col-4">
                    <div class="p-d-block" ><p><b>1.</b> Value Document&nbsp; <a (click)="showDialogOperationCard()" style="text-decoration: underline;">Upload</a></p></div>
                    <!-- <p-fileUpload name="file" url="/your-upload-url" chooseLabel="Choose" uploadLabel="Upload" cancelLabel="Cancel"></p-fileUpload> -->
                </div>
                <div class="field col-12 md:col-4">
                    <div class="p-d-block"><p><b>2.</b> Response Document&nbsp; <a (click)="showDialogOperationCard()" style="text-decoration: underline;">Upload</a></p></div>
                    <!-- <p-fileUpload name="file" url="/your-upload-url" chooseLabel="Choose" uploadLabel="Upload" cancelLabel="Cancel"></p-fileUpload> -->
                </div>
                <div class="field col-12 md:col-4">
                    <div class="p-d-block" ><p><b>3.</b> Others&nbsp; <a (click)="showDialogOperationCard()" style="text-decoration: underline;">Upload</a></p></div>
                    <!-- <p-fileUpload name="file" url="/your-upload-url" chooseLabel="Choose" uploadLabel="Upload" cancelLabel="Cancel"></p-fileUpload> -->
                </div>
            </div>
            <hr class="aligndown">
            <div class="col-12" style="display: flex;justify-content: flex-end;">
                <button pButton pRipple type="button" label="Save As Draft" [disabled]="!myForm.valid"
                    (click)="SaveAsDraftProjects()" class="p-button-outlined mr-2 mb-2"></button>
                    <button type="submit" pButton pRipple label="Continue" (click)="goToNextTab()"
                    class="mr-2 mb-2"></button>
            </div>
            <p-toast key="successToast"></p-toast>
            <p-toast key="errorToast"></p-toast>
        </form>
        <!-- <hr>
            <h6><b>Documents</b></h6>
            <p>Upload the following documnets: File Size < 5 mb,Format CSV,JPEG,Excel,PDF</p>
            <div class="p-fluid grid">
                <div class="field col-12 md:col-4">
                    <div class="p-d-block"><label>Value Document</label></div>
                    <p-fileUpload name="file" url="/your-upload-url" chooseLabel="Choose" uploadLabel="Upload" cancelLabel="Cancel"></p-fileUpload>
                </div>
                <div class="field col-12 md:col-4">
                    <div class="p-d-block"><label>Response Document</label></div>
                    <p-fileUpload name="file" url="/your-upload-url" chooseLabel="Choose" uploadLabel="Upload" cancelLabel="Cancel"></p-fileUpload>
                </div>
                <div class="field col-12 md:col-4">
                    <div class="p-d-block"><label>Others</label></div>
                    <p-fileUpload name="file" url="/your-upload-url" chooseLabel="Choose" uploadLabel="Upload" cancelLabel="Cancel"></p-fileUpload>
                </div>
            </div> -->
    </p-tabPanel>
    <p-tabPanel header="Building Block">
        <div>
          
                <app-building-block></app-building-block>

          
        </div>
        <div class="col-12" style="display: flex;justify-content: flex-end;">
            <button pButton pRipple type="button" label="Save As Draft" [disabled]="!myForm.valid"
                (click)="SaveAsDraftProjects()" class="p-button-outlined mr-2 mb-2"></button>
                <button type="submit" pButton pRipple label="Continue" (click)="goToNextTab()"
                class="mr-2 mb-2"></button>
        </div>
    </p-tabPanel>
   
    <p-tabPanel header="Add Volume">
            <div>
                <app-add-volume></app-add-volume>
                
                
            </div>
            <div class="col-12" style="display: flex;justify-content: flex-end;">
                <button pButton pRipple type="button" label="Save As Draft" [disabled]="!myForm.valid"
                    (click)="SaveAsDraftProjects()" class="p-button-outlined mr-2 mb-2"></button>
                    <button type="submit" pButton pRipple label="Continue" (click)="goToNextTab()"
                    class="mr-2 mb-2"></button>
            </div>
    </p-tabPanel>
    <p-tabPanel header="Cost Line Item">
        <div>
            <app-cost-line-item></app-cost-line-item>
           
            
        </div>
        <div class="col-12" style="display: flex;justify-content: flex-end;">
            <button pButton pRipple type="button" label="Save As Draft" [disabled]="!myForm.valid"
                (click)="SaveAsDraftProjects()" class="p-button-outlined mr-2 mb-2"></button>
                <button type="submit" pButton pRipple label="Continue" (click)="goToNextTab()"
                class="mr-2 mb-2"></button>
        </div>
    </p-tabPanel>
    <p-tabPanel header="Other Cost(Optional)">
        <div>
       <app-other-cost></app-other-cost>
        </div>
        <div class="col-12" style="display: flex;justify-content: flex-end;">
            <button pButton pRipple type="button" label="Save As Draft" [disabled]="!myForm.valid"
                (click)="SaveAsDraftProjects()" class="p-button-outlined mr-2 mb-2"></button>
                <button type="submit" pButton pRipple label="Continue" (click)="goToNextTab()"
                class="mr-2 mb-2"></button>
        </div>
    </p-tabPanel>
    <p-tabPanel header="Project Cost">
        <p>
            At vero eos et accusamus et iusto odio dignissimos ducimus qui blanditiis praesentium voluptatum deleniti
            atque corrupti quos dolores et quas molestias excepturi sint occaecati cupiditate non provident, similique
            sunt in culpa
            qui officia deserunt mollitia animi, id est laborum et dolorum fuga. Et harum quidem rerum facilis est et
            expedita distinctio. Nam libero tempore, cum soluta nobis est eligendi optio cumque nihil impedit quo minus.
        </p>
        <div class="col-12" style="display: flex;justify-content: flex-end;">
            <button pButton pRipple type="button" label="Save As Draft" [disabled]="!myForm.valid"
                (click)="SaveAsDraftProjects()" class="p-button-outlined mr-2 mb-2"></button>
                <button type="submit" pButton pRipple label="Continue" (click)="goToNextTab()"
                class="mr-2 mb-2"></button>
        </div>
    </p-tabPanel>
</p-tabView>

<!-- import from excel dialog(Operation Card) -->
<p-dialog header="Import Excel" [(visible)]="visibleOperationBox" [style]="{width: '50vw'}">
    <ng-template pTemplate="header">
        <div style="width: 100%;">
            <h5 style="display: contents;">Upload Document</h5>&nbsp;&nbsp;&nbsp;
            <h5 style="display: contents;">
                <a href="#" (click)="downloadSampleOpExcel($event)" style="text-decoration: underline;">Download Sample File</a>
              </h5>
        </div>
    </ng-template>
    <hr>
    <div>
        <div class="p-fluid grid">
            <div class="col-12 md:col-12">
                <div class="custom-container">
                    <h6><b>Instructions</b></h6>
                    <ul class="list">
                        <li>Maximum File Size: 5MB</li>
                        <li>Format CSV,JPEG,Excel,PDF</li>
                    </ul>
                    <ol class="list" type="1">
                        <li>Make sure to provide valid data</li>
                        <li>Keep file name recognizable</li>
                    </ol>
                </div>
            </div>
            <div class="col-12 md:col-12">
                <div class="custom-container">
                    <h6><b>Upload</b></h6>
                    <!-- <div *ngIf="showUploaderror" style="color: red;">
                        Upload error: All fields empty or exceeds 1000 characters. Review the file before uploading.
                    </div> -->
                    <div class="box">
                        <div class="card-body">
                            <div class="container">
                                <label for="fileInput" class="custom-file-input">
                                    <i class="pi pi-upload" style="font-size: 30px;display: block;"></i>
                                    <div class="upload_name">Upload</div>
                                </label>
                                <p style="text-align: center;">{{fileNameOC}}</p>
                                <input type="file" id="fileInput" (change)="onFileSelected($event)" style="display: none;" accept=".xlsx, .csv">
                            </div>
                        </div>
                    </div>
                    <div class="card_footer">
                        <div>
                            <button type="submit" pButton pRipple class="btn"  [disabled]="!selectedFile" (click)="onRemoveOperationClick()">
                                Remove File
                            </button>
                        </div>
                        <div class="uplodBtn_right">
                            <button type="submit" pButton pRipple class="btn"    [disabled]="!selectedFile" (click)="onUploadClick()">
                                Submit
                            </button>
                            <button type="submit" (click)="onOperarationCancelClick()" pButton pRipple class="btn">Cancel</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!-- Add this inside your p-dialog or any suitable place -->


</p-dialog>